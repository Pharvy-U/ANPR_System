# Description of the ANPR Project
### Theory behind the project

With the present population density and the large number of both commercial and private owned cars present on public roads today, it has become a problem for traffic wardens and road safety officials to effectively monitor and control traffic. However, an efficient traffic control system will not only consist of traffic wardens and toll units but also incorporates technologies that solve the problem of traffic control. Difficulties associated with access control at toll gates such as delays, and undue harassments can be addressed by automating checking and permission at toll gates. Also, with increased cases of kidnaps and vehicle theft, vehicle tracking has become a necessity. The proposed Automatic Plate Number Recognition (APNR) system for electronic toll gate monitoring can be applied to mitigate the above-mentioned problems.

I Designed and implemented a deep learning based Automatic Number Plate Recognition System with a web-based user interface, capable of detecting, localizing and recognizing vehicle plate numbers for a variety of applications. This project was designed as an embedded system and was deployed on a Raspberry Pi micro-computer. There are five main parts to this project which are image acquisition, license plate localization, image preprocessing, character segmentation and character recognition.
At the localization stage, video input is fetched from the camera to the Raspberry Pi using the popular computer vision library, OpenCV. The video input is converted to usable format for the YOLO v4 object detection algorithm using the computer vision Blob-from-image function. The YOLO v4 is a real time object detection algorithm that simultaneously detects and localizes various objects in an image. It is pre-trained for detection of objects from eighty different classes (cars, dogs, horses, toothbrushes, etc.). However, for this application we are only concerned with the detection and localization of vehicle license plates. To achieve this, custom training of the YOLO v4 CNN is performed on a single object class, the Vehicle License Plate. The dataset for this custom training is obtained from open-source platform, Kaggle. The input video is fed to the YOLO v4 CNN frame by frame for processing. In each frame, the algorithm scans for a license plate image and draws a bounding box around it, fulfilling the object detection and localization requirement.
The next stage is the segmentation stage, using information from the bounding box, the license plate is cropped out of the image and passed to the segmentation function of the algorithm. A series of operations is carried out on the license plate image by the computer vision library, preparing it for recognition. The aim of these operations is to segment the license plate image and pick out each character of the license plate number to allow for recognition. Segmentation of the license plate characters is achieved by a combination of some computer vision operations and some manual filtering to eliminate objects that are not of interest. After the characters are successfully segmented, they are fed one after the other into a second CNN (built with TensorFlow) for character recognition. The architecture is shown below.
This character recognition CNN is trained using an open-source alphanumeric dataset of 35 classes (all numbers from 0 to 9 and all the English alphabets excluding ‘O’).


### Implementation

A web-based user interface is built with the Flask framework and setup for both monitoring the system and updating the database of vehicle owners and vehicle plate numbers.
Please note that the time of designing this project, I had no knowledge of API's but I managed client-server connection using socket connection where the web-app is the server and the raspberry pi on the ground is the client.
The database information can be edited from the web user interface.
Also, please download and unzip the `yolo_custom_license_plate.rar` file from my drive [here](`https://drive.google.com/file/d/1AbooTH6YQbMndEbJlnlwecLtC06L_z4q/view?usp=sharing`), to get the custom weights and other files in the same location which are necessary for the program to run.